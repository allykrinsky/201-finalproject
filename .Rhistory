shiny::runApp()
runApp()
runApp()
# intro to report
intro <- "Our reports studies the U.S economy in the past years. There are two main data sets we used to do the analysis. One is the Dow Jones Industrial Average (DJIA) from 2014 to 2019, which measures the overall stock market performance in the U.S.. DJIA is a index measuring the stock performance of 30 companies which are the most valuable companies in the US and can largely influence the overall economy of the US. Another one is the GDP for United States from 2005 to 2018. We use the USA quarterly GDP to measure the US economy. GDP refers to gross domestic product, which measures the total value of goods and services produced in a given amount of time. In the GDP data table, we have GDP for each individual state for each quarter in all different industries including construction, mannufactuer and et.
Using these two data sets, we are going to have a better understanding of the US economy, and their interrelation. For more background knowledge on economics to help understand our report."
tab_intro <- "Our report has three tabs: Dow Jones Seasonal, GDP VS. Dow Jones, and United States GDP. These three tabs will help three questions respectively."
# three tab description will inlcude the question, significance of the question, how the user can navigate the tab.
third_tab <- paste("United States GDP Tab will provide help answer the question: How are GDPs in the two regions compared and related to each other?",
"The question will provide the user  with a better understanding of the US economy by providing the GDP stats in individual states and region. The user can choose two regions including states and larger areas, and a certain industry. Then the graph will show the U.S. GDP trend and GDP tend in these two regions from 2005 to 2018 in each quarter in the certain industry. If the user choose to compare two states’ GDP change, the graph can visualize the GDP change trend in these two states and visualize the correlation between them. If the user choose to compare a state to a larger area, the user can see if the state’s GDP influence the GDP change in that larger area. For example, the user can choose Minnesota and Midwest, and compare how much does Minnesota’s GDP change contribute to the overall GDP change in Midwest. The GDP for the United States is always shown on the graph because it provides the user with the overview of the country’s GDP change. The table will provide the user a quantitative analysis on the GDP changes for these regions. Combining the graph and table, the user can understand US economy from different perspective.",
sep = "\n"
)
runApp()
runApp()
state_one <- "Washington"
state_two <- "Midwest"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
state_one <- "Washington"
state_two <- "Midwest"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
state_one <- "Washington"
state_two <- "Midwest"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
View(gathered_industry)
View(industry_gdp)
state_one <- "Washington"
state_two <- "Midwest"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
View(state_gdp)
runApp()
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
View(state_gdp)
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
View(state_gdp)
View(industry_gdp)
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
View(gathered_industry)
grouped <- gathered_industry %>%
group_by(GeomName,year) %>%
summarise(mean_gdp <- mean(GDP))
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp <- mean(GDP))
View(grouped)
library("dplyr")
library("tidyr")
library("httr")
library("stringr")
library("ggplot2")
library("shiny")
library("plotly")
gdp <- read.csv("data/gdp.csv",stringsAsFactors = FALSE)
gdp <- select(gdp, -1, -3)
# get the list of region
get_region_name <- filter(gdp, Description == "All industry total")
region_list <- get_region_name$GeoName
# get the list of industry
get_all_industry <- filter(gdp, GeoName == "Washington")
industry_list <- trimws(get_all_industry$Description, "left")
#question <-
compared_gdp <- function(state_one,state_two, industry){
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
gathered_industry <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp <- mean(GDP))
p <- ggplot(data = gathered_industry) +
geom_line(mapping = aes(x= year, y = GDP, group = GeoName, color = GeoName))+
geom_point(mapping = aes(x= year, y = GDP, group = GeoName, color = GeoName))+
theme(
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")
)+
labs(
title = paste("The GDP in United States,",state_one,"and",state_two, " \n from 2005 to 2018 \n in", industry),
x = "year",
y = "GDP"
)
ggplotly(p)
}
runApp()
runApp()
p <- ggplot(data = gathered_industry) +
geom_line(mapping = aes(x= year, y = mean_GDP, group = GeoName, color = GeoName))+
geom_point(mapping = aes(x= year, y = mean_GDP, group = GeoName, color = GeoName))+
theme(
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")
)+
labs(
title = paste("The GDP in United States,",state_one,"and",state_two, " \n from 2005 to 2018 \n in", industry),
x = "year",
y = "GDP"
)
runApp()
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
View(grouped)
View(gathered_industry)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
View(grouped)
runApp()
runApp()
group_region <- grouped %>%
group_by(GeoName) %>%
View(grouped)
View(grouped)
View(grouped)
as.data.frame(grouped)
is.data.frame(grouped)
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
is.data.frame(grouped)
grouped_diff <- group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp))
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp))
View(grouped_diff)
spread_diff <- grouped_diff %>%
spread(GeoName,year,diff)
spread_diff <- grouped_diff %>%
spread(GeoName,year,diff, na.rm = TRUE)
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4) %>%
grouped_diff
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4) %>%
View(grouped_diff)
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
View(grouped_diff)
spread_diff <- grouped_diff %>%
spread(year,diff, na.rm = TRUE)
spread_diff <- grouped_diff %>%
spread(GeoName,diff)
View(spread_diff)
spread_diff <- grouped_diff %>%
spread(year,diff)
View(spread_diff)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
View(grouped_diff)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
spread_diff <- grouped_diff %>%
spread(year,GeoName,diff) %>%
select(-1)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
spread_diff <- grouped_diff %>%
spread(year,diff)
View(spread_diff)
View(spread_diff)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
library("dplyr")
library("tidyr")
library("httr")
library("stringr")
library("ggplot2")
library("shiny")
library("plotly")
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
View(spread_diff)
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
gdp_table <- function (state_one,state_two, industry){
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
spread_diff
}
gdp_table("Washington", "Minnesota","Construction")
View(gdp_table())
View(gdp_table("Washington", "Minnesota","Construction")
View(gdp_table("Washington", "Minnesota","Construction")
View(table)
table_chart <- gdp_table("Washington", "Minnesota","Construction")
View(table_chart)
library("dplyr")
library("tidyr")
library("httr")
library("stringr")
library("ggplot2")
library("shiny")
library("plotly")
gdp <- read.csv("data/gdp.csv",stringsAsFactors = FALSE)
gdp <- select(gdp, -1, -3)
# get the list of region
get_region_name <- filter(gdp, Description == "All industry total")
region_list <- get_region_name$GeoName
# get the list of industry
get_all_industry <- filter(gdp, GeoName == "Washington")
industry_list <- trimws(get_all_industry$Description, "left")
#question <-
compared_gdp <- function(state_one,state_two, industry){
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
p <- ggplot(data = gathered_industry) +
geom_line(mapping = aes(x= year, y = GDP, group = GeoName, color = GeoName))+
geom_point(mapping = aes(x= year, y = GDP, group = GeoName, color = GeoName))+
theme(
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")
)+
labs(
title = paste("The GDP in United States,",state_one,"and",state_two, " \n from 2005 to 2018 \n in", industry),
x = "year",
y = "GDP"
)
ggplotly(p)
}
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
gdp_table <- function (state_one,state_two, industry){
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
spread_diff
}
#table_chart <- gdp_table("Washington", "Minnesota","Construction")
#compared_gdp("Washington",industry <- "Construction")
table_chart <- gdp_table("Washington", "Minnesota","Construction")
library("dplyr")
library("tidyr")
library("httr")
library("stringr")
library("ggplot2")
library("shiny")
library("plotly")
gdp <- read.csv("data/gdp.csv",stringsAsFactors = FALSE)
gdp <- select(gdp, -1, -3)
# get the list of region
get_region_name <- filter(gdp, Description == "All industry total")
region_list <- get_region_name$GeoName
# get the list of industry
get_all_industry <- filter(gdp, GeoName == "Washington")
industry_list <- trimws(get_all_industry$Description, "left")
#question <-
compared_gdp <- function(state_one,state_two, industry){
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
p <- ggplot(data = gathered_industry) +
geom_line(mapping = aes(x= year, y = GDP, group = GeoName, color = GeoName))+
geom_point(mapping = aes(x= year, y = GDP, group = GeoName, color = GeoName))+
theme(
panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black")
)+
labs(
title = paste("The GDP in United States,",state_one,"and",state_two, " \n from 2005 to 2018 \n in", industry),
x = "year",
y = "GDP"
)
ggplotly(p)
}
state_one <- "Washington"
state_two <- "California"
industry <- "Construction"
state_gdp <- filter(gdp, GeoName == state_one |GeoName == state_two | GeoName == "United States*")
gdp_table <- function (state_one,state_two, industry){
# remove the blank space in the begining
remove_space <- trimws(state_gdp$Description, "left")
state_gdp$Description = remove_space
industry_gdp <- filter(state_gdp,Description == industry)
#View(industry_gdp)
gathered_industry <- gather(industry_gdp, time, GDP, 3:57) %>%
# add a column for the year
mutate(year = substr(time, 2,5))
gathered_industry$GDP = as.numeric(gathered_industry$GDP)
grouped <- gathered_industry %>%
group_by(GeoName,year) %>%
summarise(mean_gdp = mean(GDP))
grouped_diff <- grouped %>%
group_by(GeoName) %>%
arrange(year) %>%
mutate(diff = mean_gdp - lag(mean_gdp), default = first(mean_gdp)) %>%
select(1,2,4)
spread_diff <- grouped_diff %>%
spread(year,diff) %>%
select(-1)
spread_diff
}
#table_chart <- gdp_table("Washington", "Minnesota","Construction")
#compared_gdp("Washington",industry <- "Construction")
